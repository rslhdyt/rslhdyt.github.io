<!DOCTYPE html> <html lang="en" class="h-full"> <head> <!-- Global site tag (gtag.js) - Google Analytics --> <script async src="https://www.googletagmanager.com/gtag/js?id=G-2LTH48DE8D"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-2LTH48DE8D'); </script> <meta charset="utf-8"> <meta name=viewport content="width=device-width, initial-scale=1"> <meta name=author content="Risal Hidayat"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Creating Mock Servers Using json-server | Risal Hidayat</title> <meta name="generator" content="Jekyll v4.2.2" /> <meta property="og:title" content="Creating Mock Servers Using json-server" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="When dealing with legacy systems, sometimes the best integration is the one that doesn‚Äôt require actually integrating at all üòÑ" /> <meta property="og:description" content="When dealing with legacy systems, sometimes the best integration is the one that doesn‚Äôt require actually integrating at all üòÑ" /> <link rel="canonical" href="https://rslhdyt.dev/creating-mock-servers-using-json-server/" /> <meta property="og:url" content="https://rslhdyt.dev/creating-mock-servers-using-json-server/" /> <meta property="og:site_name" content="Risal Hidayat" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2025-10-06T17:00:00+00:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Creating Mock Servers Using json-server" /> <meta name="twitter:site" content="@" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-10-06T17:00:00+00:00","datePublished":"2025-10-06T17:00:00+00:00","description":"When dealing with legacy systems, sometimes the best integration is the one that doesn‚Äôt require actually integrating at all üòÑ","headline":"Creating Mock Servers Using json-server","mainEntityOfPage":{"@type":"WebPage","@id":"https://rslhdyt.dev/creating-mock-servers-using-json-server/"},"url":"https://rslhdyt.dev/creating-mock-servers-using-json-server/"}</script> <!-- End Jekyll SEO tag --> <link rel="apple-touch-icon" sizes="180x180" href="https://rslhdyt.dev/assets/images/favicon/apple-touch-icon.png"> <link rel="icon" type="image/png" sizes="32x32" href="https://rslhdyt.dev/assets/images/favicon/favicon-32x32.png"> <link rel="icon" type="image/png" sizes="16x16" href="https://rslhdyt.dev/assets/images/favicon/favicon-16x16.png"> <link rel="manifest" href="https://rslhdyt.dev/site.webmanifest"> <link rel="alternate" type="application/rss+xml" title="Risal Hidayat" href="https://rslhdyt.dev/feed.xml" /> <script src="https://kit.fontawesome.com/d9b09040a7.js" crossorigin="anonymous"></script> <!-- highlight.js --> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/a11y-dark.min.css" integrity="sha512-Vj6gPCk8EZlqnoveEyuGyYaWZ1+jyjMPg8g4shwyyNlRQl6d3L9At02ZHQr5K6s5duZl/+YKMnM3/8pDhoUphg==" crossorigin="anonymous" referrerpolicy="no-referrer" /> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script> <script>hljs.highlightAll();</script> <link rel="stylesheet" href="/assets/css/main.css"> </head> <body class="bg-zinc-50 flex h-full"> <div class="max-w-[600px] flex flex-col mx-auto w-11/12"> <nav class=" mt-7 md:mt-10 mb-10"> <ul class="flex flex-row justify-center space-x-6 text-l text-gray-500"> <li> <a href="https://rslhdyt.dev/">Home</a> </li> <li> <a href="https://rslhdyt.dev/blog">Blog</a> </li> <li class="item hidden sm:block"> <a href="https://rslhdyt.dev/code_snippet">Code Snippet</a> </li> <li> <a href="https://rslhdyt.dev/projects">Projects</a> </li> <li> <a href="https://rslhdyt.dev/about">About</a> </li> </ul> </nav> <h1 class="text-3xl text-center tracking-tight font-bold mb-5">Creating Mock Servers Using json-server</h1> <span class="block text-center mb-5"> <time datetime="06-10-2025">Monday. October 06, 2025</time> - <span class="reading-time" title="Estimated read time"> 9 mins read </span> </span> <div class="flex flex-row space-x-1.5 justify-center mb-10"> <a class="bg-gray-200 px-2 rounded-sm font-thin" href="https://rslhdyt.dev/tags/testing">testing</a> <a class="bg-gray-200 px-2 rounded-sm font-thin" href="https://rslhdyt.dev/tags/api">api</a> <a class="bg-gray-200 px-2 rounded-sm font-thin" href="https://rslhdyt.dev/tags/tutorial">tutorial</a> </div> <div class="posts"> <p><img src="https://images.unsplash.com/photo-1528869294317-c5cc1ebacaab?ixlib=rb-4.1.0&amp;q=85&amp;fm=jpg&amp;crop=entropy&amp;cs=srgb" alt="" /></p> <p>When you inherit a legacy project, the first thing you want to do is get it running locally. Clone the repo, install dependencies, maybe spin up some Docker containers, and you‚Äôre good to go. But legacy systems have their own ideas about cooperation.</p> <p>I recently had to work on improving a process that integrated with an old internal system. This wasn‚Äôt just ‚Äúa few versions behind‚Äù old - we‚Äôre talking Windows Server 2012, SQL Server 2008, and a an app that I never heard before. The system communicated via HTTP, which should‚Äôve made things simple. Instead, I spent two days trying to get the environment working on my Mac. Between incompatible SQL Server drivers, Windows-specific dependencies, framework versions that refused to run outside their natural habitat, and my laptop‚Äôs very limited RAM struggling with the resource-hungry legacy stack, I realized I was fighting a losing battle.</p> <h2 id="why-json-server-solves-this-problem">Why json-server Solves This Problem</h2> <p><strong>json-server</strong> is a full fake REST API with zero coding required. It‚Äôs perfect when you need to mock an external service quickly without dealing with complex infrastructure. In my case, instead of wrestling with outdated dependencies and database versions, I could simulate the legacy API‚Äôs responses and continue development.</p> <p>The benefits for legacy system integration:</p> <ul> <li><strong>No dependencies on the actual service</strong> - develop offline or when the service is down</li> <li><strong>Predictable responses</strong> - test edge cases without manipulating production data</li> <li><strong>Fast iteration</strong> - modify responses instantly without database changes</li> <li><strong>Team collaboration</strong> - share the mock server configuration with your team</li> </ul> <h2 id="setting-up-json-server">Setting Up json-server</h2> <p>First, install json-server as a development dependency:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm <span class="nb">install</span> <span class="nt">--save-dev</span> json-server
</code></pre></div></div> <p>Create a <code class="language-plaintext highlighter-rouge">db.json</code> file with your mock data structure:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"users"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John Doe"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"john@example.com"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jane Smith"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jane@example.com"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"inactive"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"transactions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nl">"userId"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">150.00</span><span class="p">,</span><span class="w">
      </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"completed"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2024-01-15T10:30:00Z"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>Add a script to your <code class="language-plaintext highlighter-rouge">package.json</code>:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"scripts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"mock-server"</span><span class="p">:</span><span class="w"> </span><span class="s2">"json-server --watch db.json --port 3001"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>Now you can run:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm run mock-server
</code></pre></div></div> <p>This gives you a fully functional REST API at <code class="language-plaintext highlighter-rouge">http://localhost:3001</code> with GET, POST, PUT, PATCH, and DELETE operations on your resources.</p> <h2 id="custom-server-for-dynamic-endpoints">Custom Server for Dynamic Endpoints</h2> <p>The basic setup works great for simple cases, but legacy systems often have quirky endpoints and custom logic. Here‚Äôs how to create a custom server with dynamic routing:</p> <p>Create a <code class="language-plaintext highlighter-rouge">server.js</code> file:</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// server.js</span>
<span class="kd">const</span> <span class="nx">jsonServer</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">json-server</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">jsonServer</span><span class="p">.</span><span class="nx">create</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">router</span> <span class="o">=</span> <span class="nx">jsonServer</span><span class="p">.</span><span class="nx">router</span><span class="p">(</span><span class="dl">'</span><span class="s1">db.json</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">middlewares</span> <span class="o">=</span> <span class="nx">jsonServer</span><span class="p">.</span><span class="nx">defaults</span><span class="p">();</span>

<span class="c1">// Add custom middleware</span>
<span class="nx">server</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">middlewares</span><span class="p">);</span>

<span class="c1">// Parse JSON bodies</span>
<span class="nx">server</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">jsonServer</span><span class="p">.</span><span class="nx">bodyParser</span><span class="p">);</span>

<span class="c1">// Custom routes before json-server router</span>
<span class="nx">server</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">/api/v1/users/:id/full-profile</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">userId</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">db</span> <span class="o">=</span> <span class="nx">router</span><span class="p">.</span><span class="nx">db</span><span class="p">;</span> <span class="c1">// Access lowdb instance</span>

  <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">db</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">users</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">find</span><span class="p">({</span> <span class="na">id</span><span class="p">:</span> <span class="nx">userId</span> <span class="p">})</span>
    <span class="p">.</span><span class="nx">value</span><span class="p">();</span>

  <span class="kd">const</span> <span class="nx">transactions</span> <span class="o">=</span> <span class="nx">db</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">transactions</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">filter</span><span class="p">({</span> <span class="na">userId</span><span class="p">:</span> <span class="nx">userId</span> <span class="p">})</span>
    <span class="p">.</span><span class="nx">value</span><span class="p">();</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">404</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span> <span class="na">error</span><span class="p">:</span> <span class="dl">'</span><span class="s1">User not found</span><span class="dl">'</span> <span class="p">});</span>
  <span class="p">}</span>

  <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span>
    <span class="na">user</span><span class="p">:</span> <span class="nx">user</span><span class="p">,</span>
    <span class="na">transactions</span><span class="p">:</span> <span class="nx">transactions</span><span class="p">,</span>
    <span class="na">transactionCount</span><span class="p">:</span> <span class="nx">transactions</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
    <span class="na">totalAmount</span><span class="p">:</span> <span class="nx">transactions</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span> <span class="nx">t</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">sum</span> <span class="o">+</span> <span class="nx">t</span><span class="p">.</span><span class="nx">amount</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
  <span class="p">});</span>
<span class="p">});</span>

<span class="c1">// Simulate legacy system's weird authentication endpoint</span>
<span class="nx">server</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="dl">'</span><span class="s1">/legacy/auth/validate</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">token</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>

  <span class="c1">// Mock validation logic</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">token</span> <span class="o">&amp;&amp;</span> <span class="nx">token</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="dl">'</span><span class="s1">valid_</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span>
      <span class="na">success</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="na">userId</span><span class="p">:</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">token</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="s1">_</span><span class="dl">'</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="o">||</span> <span class="mi">1</span><span class="p">,</span>
      <span class="na">permissions</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">read</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">write</span><span class="dl">'</span><span class="p">]</span>
    <span class="p">});</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">401</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span>
      <span class="na">success</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="na">error</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Invalid token</span><span class="dl">'</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// Add delay to simulate network latency</span>
<span class="nx">server</span><span class="p">.</span><span class="nx">use</span><span class="p">((</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">next</span><span class="p">,</span> <span class="mi">500</span><span class="p">);</span> <span class="c1">// 500ms delay</span>
<span class="p">});</span>

<span class="c1">// Custom error responses to match legacy system</span>
<span class="nx">server</span><span class="p">.</span><span class="nx">use</span><span class="p">((</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">method</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">POST</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">createdAt</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="nx">next</span><span class="p">();</span>
<span class="p">});</span>

<span class="c1">// Use default router</span>
<span class="nx">server</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="dl">'</span><span class="s1">/api</span><span class="dl">'</span><span class="p">,</span> <span class="nx">router</span><span class="p">);</span>

<span class="c1">// Custom 404 handler</span>
<span class="nx">server</span><span class="p">.</span><span class="nx">use</span><span class="p">((</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">404</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span>
    <span class="na">error</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Endpoint not found</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">path</span><span class="p">:</span> <span class="nx">req</span><span class="p">.</span><span class="nx">path</span><span class="p">,</span>
    <span class="na">timestamp</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">()</span>
  <span class="p">});</span>
<span class="p">});</span>

<span class="kd">const</span> <span class="nx">PORT</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">MOCK_SERVER_PORT</span> <span class="o">||</span> <span class="mi">3001</span><span class="p">;</span>
<span class="nx">server</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">PORT</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`JSON Server is running on port </span><span class="p">${</span><span class="nx">PORT</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`http://localhost:</span><span class="p">${</span><span class="nx">PORT</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div> <p>For more complex scenarios with middleware chains:</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// middleware.js</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// Add custom headers like the legacy system</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">header</span><span class="p">(</span><span class="dl">'</span><span class="s1">X-Legacy-System</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">v1.0</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">header</span><span class="p">(</span><span class="dl">'</span><span class="s1">X-Response-Time</span><span class="dl">'</span><span class="p">,</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">());</span>

  <span class="c1">// Log all requests</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">()}</span><span class="s2"> - </span><span class="p">${</span><span class="nx">req</span><span class="p">.</span><span class="nx">method</span><span class="p">}</span><span class="s2"> </span><span class="p">${</span><span class="nx">req</span><span class="p">.</span><span class="nx">path</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>

  <span class="c1">// Validate API key for certain endpoints</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">path</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="dl">'</span><span class="s1">/api/secured</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">apiKey</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">headers</span><span class="p">[</span><span class="dl">'</span><span class="s1">x-api-key</span><span class="dl">'</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">apiKey</span> <span class="o">||</span> <span class="nx">apiKey</span> <span class="o">!==</span> <span class="dl">'</span><span class="s1">test-key-123</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">403</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span>
        <span class="na">error</span><span class="p">:</span> <span class="dl">'</span><span class="s1">API key required</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">code</span><span class="p">:</span> <span class="dl">'</span><span class="s1">MISSING_API_KEY</span><span class="dl">'</span>
      <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nx">next</span><span class="p">();</span>
<span class="p">};</span>
</code></pre></div></div> <p>Update your <code class="language-plaintext highlighter-rouge">server.js</code> to use the middleware:</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">customMiddleware</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">./middleware</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">server</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">customMiddleware</span><span class="p">);</span>
</code></pre></div></div> <h2 id="running-and-testing-the-mock-server">Running and Testing the Mock Server</h2> <p>Create a <code class="language-plaintext highlighter-rouge">routes.json</code> file for URL rewriting to match your legacy system‚Äôs patterns:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"/old-api/get-user/:id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/users/:id"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"/legacy/transactions/user/:userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/transactions?userId=:userId"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"/v1/users\\?id=:id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/users/:id"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>Update your package.json with different configurations:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"scripts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"mock:basic"</span><span class="p">:</span><span class="w"> </span><span class="s2">"json-server --watch db.json --port 3001"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"mock:custom"</span><span class="p">:</span><span class="w"> </span><span class="s2">"node server.js"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"mock:routes"</span><span class="p">:</span><span class="w"> </span><span class="s2">"json-server --watch db.json --routes routes.json --port 3001"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"mock:dev"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nodemon server.js"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>Test your endpoints using curl or httpie:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Test basic CRUD</span>
curl http://localhost:3001/api/users

<span class="c"># Test custom endpoint</span>
curl http://localhost:3001/api/v1/users/1/full-profile

<span class="c"># Test with custom headers</span>
curl <span class="nt">-H</span> <span class="s2">"X-API-Key: test-key-123"</span> <span class="se">\</span>
     http://localhost:3001/api/secured/users

<span class="c"># Test POST with authentication</span>
curl <span class="nt">-X</span> POST <span class="se">\</span>
     <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
     <span class="nt">-d</span> <span class="s1">'{"token":"valid_123"}'</span> <span class="se">\</span>
     http://localhost:3001/legacy/auth/validate
</code></pre></div></div> <h2 id="wrapping-up">Wrapping Up</h2> <p>json-server transformed what could have been days of environment setup into a 30-minute solution. Instead of fighting with legacy dependencies, you can focus on building your integration. The mock server is also invaluable for:</p> <ul> <li><strong>Frontend development</strong> when the backend isn‚Äôt ready</li> <li><strong>Integration testing</strong> without hitting production APIs</li> <li><strong>Demo environments</strong> that need predictable data</li> <li><strong>Documentation</strong> by showing example responses</li> </ul> <p>You might also want to explore <strong>WireMock</strong> if you need more sophisticated request matching. But for quickly mocking REST APIs, especially legacy systems, json-server hits the sweet spot between simplicity and functionality.</p> <p><strong>When dealing with legacy systems, sometimes the best integration is the one that doesn‚Äôt require actually integrating at all</strong> üòÑ</p> </div> <div class="grid grid-cols-2 text-sm"> <a class="prev" href="https://rslhdyt.dev/toctou-vs-dirty-read/">&laquo; TOCTOU vs Dirty Read</a> </div> <div class="related"> <h4 class="text-xl my-5">Related Posts</h4> <ul class="list-disc list-inside"> <li class="pl-8"> <a href="https://rslhdyt.dev/creating-custom-ufw-application-profiles/">Creating Custom UFW Application Profiles </a> </li> <li class="pl-8"> <a href="https://rslhdyt.dev/rails-authentication-setup-omniauth-using-devise/">Rails Authentication: Setup Omniauth using Devise </a> </li> <li class="pl-8"> <a href="https://rslhdyt.dev/rails-authentication-login-with-magic-link/">Rails Authentication Login with magic link </a> </li> <li class="pl-8"> <a href="https://rslhdyt.dev/rails-rake-task-hooks/">Rails - Rake Task Hooks </a> </li> <li class="pl-8"> <a href="https://rslhdyt.dev/rails-email-preview/">Rails Email Preview </a> </li> </ul> </div> <footer class="flex justify-center items-center border-solid border-0 border-t border-gray-200 p-10 mt-10"> Risal Hidayat ¬© 2025 </footer> </div> </body> </html>
