<!DOCTYPE html> <html lang="en" class="h-full"> <head> <!-- Global site tag (gtag.js) - Google Analytics --> <script async src="https://www.googletagmanager.com/gtag/js?id=G-2LTH48DE8D"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-2LTH48DE8D'); </script> <meta charset="utf-8"> <meta name=viewport content="width=device-width, initial-scale=1"> <meta name=author content="Risal Hidayat"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Navigating Docker Debugging Challenges: Overriding ENTRYPOINT | Risal Hidayat</title> <meta name="generator" content="Jekyll v4.2.2" /> <meta property="og:title" content="Navigating Docker Debugging Challenges: Overriding ENTRYPOINT" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="The process of debugging a Docker container that refuses to run can be challenging, especially when an image fails across various environments due to missing configurations. This article provides a solution to this issue by explaining how to override the ENTRYPOINT using the –entrypoint flag." /> <meta property="og:description" content="The process of debugging a Docker container that refuses to run can be challenging, especially when an image fails across various environments due to missing configurations. This article provides a solution to this issue by explaining how to override the ENTRYPOINT using the –entrypoint flag." /> <link rel="canonical" href="https://rslhdyt.dev/navigating-docker-debugging-challenges-overriding-entrypoint/" /> <meta property="og:url" content="https://rslhdyt.dev/navigating-docker-debugging-challenges-overriding-entrypoint/" /> <meta property="og:site_name" content="Risal Hidayat" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2024-03-15T17:00:00+00:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Navigating Docker Debugging Challenges: Overriding ENTRYPOINT" /> <meta name="twitter:site" content="@" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-03-15T17:00:00+00:00","datePublished":"2024-03-15T17:00:00+00:00","description":"The process of debugging a Docker container that refuses to run can be challenging, especially when an image fails across various environments due to missing configurations. This article provides a solution to this issue by explaining how to override the ENTRYPOINT using the –entrypoint flag.","headline":"Navigating Docker Debugging Challenges: Overriding ENTRYPOINT","mainEntityOfPage":{"@type":"WebPage","@id":"https://rslhdyt.dev/navigating-docker-debugging-challenges-overriding-entrypoint/"},"url":"https://rslhdyt.dev/navigating-docker-debugging-challenges-overriding-entrypoint/"}</script> <!-- End Jekyll SEO tag --> <link rel="apple-touch-icon" sizes="180x180" href="https://rslhdyt.dev/assets/images/favicon/apple-touch-icon.png"> <link rel="icon" type="image/png" sizes="32x32" href="https://rslhdyt.dev/assets/images/favicon/favicon-32x32.png"> <link rel="icon" type="image/png" sizes="16x16" href="https://rslhdyt.dev/assets/images/favicon/favicon-16x16.png"> <link rel="manifest" href="https://rslhdyt.dev/site.webmanifest"> <link rel="canonical" href="https://rslhdyt.dev/navigating-docker-debugging-challenges-overriding-entrypoint/"> <link rel="alternate" type="application/rss+xml" title="Risal Hidayat" href="https://rslhdyt.dev/feed.xml" /> <script src="https://kit.fontawesome.com/d9b09040a7.js" crossorigin="anonymous"></script> <!-- highlight.js --> <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/github-dark-dimmed.min.css"> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script> <script>hljs.highlightAll();</script> <link rel="stylesheet" href="/assets/css/main.css"> </head> <body class="bg-zinc-50 flex h-full"> <div class="max-w-[600px] flex flex-col mx-auto w-11/12"> <div class="post"> <nav class=" mt-7 md:mt-10 mb-10"> <ul class="flex flex-row justify-center space-x-6 text-l text-gray-500"> <li> <a href="https://rslhdyt.dev/">Home</a> </li> <li> <a href="https://rslhdyt.dev/blog">Blog</a> </li> <li class="item hidden sm:block"> <a href="https://rslhdyt.dev/code_snippet">Code Snippet</a> </li> <li> <a href="https://rslhdyt.dev/projects">Projects</a> </li> <li> <a href="https://rslhdyt.dev/about">About</a> </li> </ul> </nav> <h1 class="text-3xl text-center tracking-tight font-bold mb-5">Navigating Docker Debugging Challenges: Overriding ENTRYPOINT</h1> <span class="block text-center mb-5"> <time datetime="15-03-2024">Friday. March 15, 2024</time> - <span class="reading-time" title="Estimated read time"> 1 min read </span> </span> <div class="flex flex-row space-x-1.5 justify-center mb-10"> <a class="bg-gray-200 px-2 rounded-sm font-thin" href="https://rslhdyt.dev/tags/docker">docker</a> <a class="bg-gray-200 px-2 rounded-sm font-thin" href="https://rslhdyt.dev/tags/tips">tips</a> </div> <p><img src="https://images.unsplash.com/photo-1703227373720-cff89520dd31?ixlib=rb-4.0.3&amp;q=85&amp;fm=jpg&amp;crop=entropy&amp;cs=srgb" alt="" /></p> <p><em>Image from <a href="https://unsplash.com/@hdbernd">Bern Dittrich</a> from Unsplash</em></p> <p>Debugging a Docker container that won’t run can be hard. It’s even harder when an image fails to run in different environments because of missing configurations.</p> <p>Just recently, I had this problem. My application container wouldn’t run in the production environment. After a long night of debugging, I finally found the problem.</p> <div class="language-docker highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run --detach --name app --env-file .env-production docker/image
</code></pre></div></div> <p>When I run docker run command to run my Rails application with above command. My Rails application container wouldn’t start because the <code class="language-plaintext highlighter-rouge">ENTRYPOINT</code> command, which sets up the initial database, failed. The application couldn’t connect to the PostgreSQL database, so the container stopped at that step.</p> <div class="language-docker highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Run and own only the runtime files as a non-root user for security</span>
<span class="k">RUN </span>useradd rails <span class="nt">--create-home</span> <span class="nt">--shell</span> /bin/bash <span class="o">&amp;&amp;</span> <span class="se">\
</span>    <span class="nb">chown</span> <span class="nt">-R</span> rails:rails db log storage tmp
<span class="k">USER</span><span class="s"> rails:rails</span>

<span class="c"># Entrypoint prepares the database.</span>
<span class="k">ENTRYPOINT</span><span class="s"> ["/rails/bin/docker-entrypoint"]</span>

<span class="c"># Start the server by default, this can be overwritten at runtime</span>
<span class="k">EXPOSE</span><span class="s"> 3000</span>
<span class="k">CMD</span><span class="s"> ["./bin/rails", "server"]</span>

</code></pre></div></div> <p>One solution could be to rebuild the image, remove the <code class="language-plaintext highlighter-rouge">ENTRYPOINT</code> command, and then debug inside the Docker container. But this can take a lot of time, especially when your Docker image size is large.</p> <p>Then I learned something new. We can change the <code class="language-plaintext highlighter-rouge">ENTRYPOINT</code> when we start a Docker container by using the <code class="language-plaintext highlighter-rouge">--entrypoint</code> flag.</p> <div class="language-docker highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run -it --name app --env-file .env-production --entrypoint bin/bash docker/image
</code></pre></div></div> <p>With this command, you can directly dive into the Docker container, bypassing the usual entry point. This opens up a new avenue for debugging and identifying missing configurations, saving valuable time and effort.</p> <div class="grid grid-cols-2 text-sm"> <a class="prev"></a> </div> <div class="related"> <h4 class="text-xl my-5">Related Posts</h4> <ul class="list-disc list-inside"> <li class="pl-8"> <a href="https://rslhdyt.dev/flipper-retrieve-a-list-of-features-for-an-actor/">Flipper: Retrieve a List of Features for an Actor </a> </li> <li class="pl-8"> <a href="https://rslhdyt.dev/race-conditions-in-ruby-what-they-are-and-how-to-avoid-them/">Race conditions in Ruby what they are and how to avoid them </a> </li> <li class="pl-8"> <a href="https://rslhdyt.dev/rails-rake-task-hooks/">Rails - Rake Task Hooks </a> </li> </ul> </div> <footer class="flex justify-center items-center border-solid border-0 border-t border-gray-200 p-10 mt-10"> Risal Hidayat © 2024 </footer> </div> </div> </div> </div> </body> </html>
