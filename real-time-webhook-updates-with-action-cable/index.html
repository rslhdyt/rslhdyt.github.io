<!DOCTYPE html> <html lang="en" class="h-full"> <head> <!-- Global site tag (gtag.js) - Google Analytics --> <script async src="https://www.googletagmanager.com/gtag/js?id=G-2LTH48DE8D"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-2LTH48DE8D'); </script> <meta charset="utf-8"> <meta name=viewport content="width=device-width, initial-scale=1"> <meta name=author content="Risal Hidayat"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Real-time Webhook Updates with Action Cable | Risal Hidayat</title> <meta name="generator" content="Jekyll v4.2.2" /> <meta property="og:title" content="Real-time Webhook Updates with Action Cable" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Learn how to build real-time webhook debugging capabilities using Ruby on Rails and Action Cable. This hands-on tutorial walks through implementing WebSocket functionality from scratch, including channel setup, broadcasting events, and frontend updates. Perfect for Rails developers looking to add live updates to their applications. Includes practical code examples and step-by-step instructions for building a webhook testing tool." /> <meta property="og:description" content="Learn how to build real-time webhook debugging capabilities using Ruby on Rails and Action Cable. This hands-on tutorial walks through implementing WebSocket functionality from scratch, including channel setup, broadcasting events, and frontend updates. Perfect for Rails developers looking to add live updates to their applications. Includes practical code examples and step-by-step instructions for building a webhook testing tool." /> <link rel="canonical" href="https://rslhdyt.dev/real-time-webhook-updates-with-action-cable/" /> <meta property="og:url" content="https://rslhdyt.dev/real-time-webhook-updates-with-action-cable/" /> <meta property="og:site_name" content="Risal Hidayat" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2024-04-02T00:00:00+00:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Real-time Webhook Updates with Action Cable" /> <meta name="twitter:site" content="@" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-04-02T00:00:00+00:00","datePublished":"2024-04-02T00:00:00+00:00","description":"Learn how to build real-time webhook debugging capabilities using Ruby on Rails and Action Cable. This hands-on tutorial walks through implementing WebSocket functionality from scratch, including channel setup, broadcasting events, and frontend updates. Perfect for Rails developers looking to add live updates to their applications. Includes practical code examples and step-by-step instructions for building a webhook testing tool.","headline":"Real-time Webhook Updates with Action Cable","mainEntityOfPage":{"@type":"WebPage","@id":"https://rslhdyt.dev/real-time-webhook-updates-with-action-cable/"},"url":"https://rslhdyt.dev/real-time-webhook-updates-with-action-cable/"}</script> <!-- End Jekyll SEO tag --> <link rel="apple-touch-icon" sizes="180x180" href="https://rslhdyt.dev/assets/images/favicon/apple-touch-icon.png"> <link rel="icon" type="image/png" sizes="32x32" href="https://rslhdyt.dev/assets/images/favicon/favicon-32x32.png"> <link rel="icon" type="image/png" sizes="16x16" href="https://rslhdyt.dev/assets/images/favicon/favicon-16x16.png"> <link rel="manifest" href="https://rslhdyt.dev/site.webmanifest"> <link rel="alternate" type="application/rss+xml" title="Risal Hidayat" href="https://rslhdyt.dev/feed.xml" /> <script src="https://kit.fontawesome.com/d9b09040a7.js" crossorigin="anonymous"></script> <!-- highlight.js --> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/a11y-dark.min.css" integrity="sha512-Vj6gPCk8EZlqnoveEyuGyYaWZ1+jyjMPg8g4shwyyNlRQl6d3L9At02ZHQr5K6s5duZl/+YKMnM3/8pDhoUphg==" crossorigin="anonymous" referrerpolicy="no-referrer" /> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script> <script>hljs.highlightAll();</script> <link rel="stylesheet" href="/assets/css/main.css"> </head> <body class="bg-zinc-50 flex h-full"> <div class="max-w-[600px] flex flex-col mx-auto w-11/12"> <nav class=" mt-7 md:mt-10 mb-10"> <ul class="flex flex-row justify-center space-x-6 text-l text-gray-500"> <li> <a href="https://rslhdyt.dev/">Home</a> </li> <li> <a href="https://rslhdyt.dev/blog">Blog</a> </li> <li class="item hidden sm:block"> <a href="https://rslhdyt.dev/code_snippet">Code Snippet</a> </li> <li> <a href="https://rslhdyt.dev/projects">Projects</a> </li> <li> <a href="https://rslhdyt.dev/about">About</a> </li> </ul> </nav> <h1 class="text-3xl text-center tracking-tight font-bold mb-5">Real-time Webhook Updates with Action Cable</h1> <span class="block text-center mb-5"> <time datetime="02-04-2024">Tuesday. April 02, 2024</time> - <span class="reading-time" title="Estimated read time"> 6 mins read </span> </span> <div class="flex flex-row space-x-1.5 justify-center mb-10"> <a class="bg-gray-200 px-2 rounded-sm font-thin" href="https://rslhdyt.dev/tags/webhookdump">webhookdump</a> <a class="bg-gray-200 px-2 rounded-sm font-thin" href="https://rslhdyt.dev/tags/rails">rails</a> <a class="bg-gray-200 px-2 rounded-sm font-thin" href="https://rslhdyt.dev/tags/websocket">websocket</a> <a class="bg-gray-200 px-2 rounded-sm font-thin" href="https://rslhdyt.dev/tags/action-cable">action-cable</a> </div> <div class="posts"> <blockquote> <p>üí° See the code for this post on the üîó <a href="https://github.com/rslhdyt/webhookdump/pull/4/files">webhook-realtime-update</a> branch.</p> </blockquote> <p>Every side project has a story, and webhookdump‚Äôs story began with a common developer frustration. At the time, I was working heavily with third-party integrations that relied on webhook callbacks. During development, I found myself repeatedly setting up temporary endpoints just to debug these callbacks. While I knew I wanted to learn WebSocket programming, and there were plenty of typical WebSocket project ideas like chat applications or WebRTC implementations, my immediate pain point was webhook debugging.</p> <p>The ‚Äúaha‚Äù moment came when I realized I could combine my learning goals with solving a real problem: why not build a webhook debugging tool with real-time updates? This would not only help me learn WebSocket programming through Action Cable but also create something immediately useful for my daily work.</p> <p>In this post, I‚Äôll walk you through how I added real-time updates to webhookdump using Action Cable. Let‚Äôs break it down step by step.</p> <h2 id="prerequisites">Prerequisites</h2> <p>Before we dive in, make sure you have Redis set up. Action Cable uses Redis as its pub/sub backend in production.</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># config/cable.yml</span>
<span class="na">development</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">redis</span>
  <span class="na">url</span><span class="pi">:</span> <span class="s">redis://localhost:6379/1</span>

<span class="nn">...</span>
</code></pre></div></div> <h2 id="creating-the-websocket-channel">Creating the WebSocket Channel</h2> <p>First, let‚Äôs generate our WebSocket channel:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rails g channel webhook_request
</code></pre></div></div> <p>This creates <code class="language-plaintext highlighter-rouge">app/channels/webhook_request_channel.rb</code>. Let‚Äôs update it:</p> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">WebhookRequestChannel</span> <span class="o">&lt;</span> <span class="no">ApplicationCable</span><span class="o">::</span><span class="no">Channel</span>
  <span class="k">def</span> <span class="nf">subscribed</span>
    <span class="n">stream_for</span> <span class="s2">"webhook_request:</span><span class="si">#{</span><span class="n">params</span><span class="p">[</span><span class="ss">:webhook_slug</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">unsubscribed</span>
    <span class="n">stop_all_streams</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div> <p>The <code class="language-plaintext highlighter-rouge">subscribed</code> method is called when a client connects to our channel. Here, we‚Äôre using <code class="language-plaintext highlighter-rouge">stream_for</code> instead of <code class="language-plaintext highlighter-rouge">stream_from</code> - this is a key difference. While <code class="language-plaintext highlighter-rouge">stream_from</code> lets you subscribe to a raw string identifier, <code class="language-plaintext highlighter-rouge">stream_for</code> is designed to work with Active Record models and handles the channel name generation for us. It‚Äôs particularly useful when broadcasting to specific model instances, which is exactly what we need for individual webhooks.</p> <p>The <code class="language-plaintext highlighter-rouge">unsubscribed</code> method cleans up when clients disconnect - it‚Äôs like good housekeeping for our WebSocket connections.</p> <h2 id="broadcasting-webhook-events">Broadcasting Webhook Events</h2> <p>When a new webhook request comes in, we need to broadcast it to all connected clients. I updated the <code class="language-plaintext highlighter-rouge">handler</code> action in our WebhooksController:</p> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">handler</span>
  <span class="n">webhook_request</span> <span class="o">=</span> <span class="vi">@webhook</span><span class="p">.</span><span class="nf">webhook_requests</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span>
    <span class="ss">url: </span><span class="n">request</span><span class="p">.</span><span class="nf">url</span><span class="p">,</span>
    <span class="ss">ip: </span><span class="n">request</span><span class="p">.</span><span class="nf">remote_ip</span><span class="p">,</span>
    <span class="ss">method: </span><span class="n">request</span><span class="p">.</span><span class="nf">method</span><span class="p">,</span>
    <span class="ss">host: </span><span class="n">request</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span>
    <span class="ss">headers: </span><span class="n">request_headers</span><span class="p">,</span>
    <span class="ss">query_params: </span><span class="n">request</span><span class="p">.</span><span class="nf">query_parameters</span><span class="p">.</span><span class="nf">to_json</span><span class="p">,</span>
    <span class="ss">payload: </span><span class="n">request</span><span class="p">.</span><span class="nf">body</span><span class="p">.</span><span class="nf">read</span>
  <span class="p">)</span>

  <span class="no">WebhookRequestChannel</span><span class="p">.</span><span class="nf">broadcast_to</span><span class="p">(</span>
    <span class="vi">@webhook</span><span class="p">,</span>
    <span class="p">{</span>
      <span class="ss">id: </span><span class="n">webhook_request</span><span class="p">.</span><span class="nf">id</span><span class="p">,</span>
      <span class="ss">webhook_uuid: </span><span class="vi">@webhook</span><span class="p">.</span><span class="nf">uuid</span><span class="p">,</span>
      <span class="ss">method: </span><span class="n">webhook_request</span><span class="p">.</span><span class="nf">method</span><span class="p">,</span>
      <span class="ss">ip: </span><span class="n">webhook_request</span><span class="p">.</span><span class="nf">ip</span><span class="p">,</span>
      <span class="ss">url: </span><span class="n">webhook_request</span><span class="p">.</span><span class="nf">url</span><span class="p">,</span>
      <span class="ss">created_at: </span><span class="n">webhook_request</span><span class="p">.</span><span class="nf">created_at</span>
    <span class="p">}</span>
  <span class="p">)</span>

  <span class="n">render</span> <span class="ss">plain: </span><span class="s1">'Ok'</span>
<span class="k">end</span>
</code></pre></div></div> <p>Notice how I‚Äôm only broadcasting essential information in the payload. While it‚Äôs tempting to send everything, keeping the payload minimal helps maintain good performance, especially when you‚Äôre dealing with lots of incoming webhooks.</p> <h2 id="handling-websocket-messages-in-the-frontend">Handling WebSocket Messages in the Frontend</h2> <p>Now comes the fun part - making our frontend react to these WebSocket messages. First, generate a Stimulus controller:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rails g stimulus webhook_request
</code></pre></div></div> <p>This creates our JavaScript controller. Here‚Äôs the initial setup:</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Controller</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@hotwired/stimulus</span><span class="dl">"</span>
<span class="k">import</span> <span class="nx">consumer</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">channels/consumer</span><span class="dl">"</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="kd">extends</span> <span class="nx">Controller</span> <span class="p">{</span>
  <span class="kd">static</span> <span class="nx">targets</span> <span class="o">=</span> <span class="p">[</span><span class="dl">'</span><span class="s1">webhookSlug</span><span class="dl">'</span><span class="p">]</span>

  <span class="nx">connect</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">channel</span> <span class="o">=</span> <span class="nx">consumer</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span>
      <span class="p">{</span>
        <span class="na">channel</span><span class="p">:</span> <span class="dl">'</span><span class="s1">WebhookRequestChannel</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">webhook_slug</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">webhookSlugTarget</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">received</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">received</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
      <span class="p">}</span>
    <span class="p">)</span>
  <span class="p">}</span>

  <span class="nx">disconnect</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">WebhookRequestController disconnected</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="nx">received</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Received webhook data:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>At this point, you should be able to test the connection. Send a webhook request, and you should see the data logged in your browser‚Äôs console. If you see the log message, congratulations! The WebSocket connection is working.</p> <p><img src="/assets/images/posts/6df325cc-e18d-428c-beae-16dfbe98f8c9-Webhook_Websocket_%281%29.gif" alt="" /></p> <h2 id="updating-the-ui-in-real-time">Updating the UI in Real-time</h2> <p>Now let‚Äôs make it actually update the UI. Here‚Äôs our view template:</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;table</span> <span class="na">data-controller=</span><span class="s">"webhook-request"</span> <span class="na">data-webhook-request-webhook-slug-value=</span><span class="s">"&lt;%= @webhook.slug %&gt;"</span><span class="nt">&gt;</span>

...
	<span class="nt">&lt;tbody</span> <span class="na">id=</span><span class="s">"webhook-request-list"</span><span class="nt">&gt;</span>
	  <span class="nt">&lt;</span><span class="err">%</span> <span class="err">@</span><span class="na">webhook_requests.each</span> <span class="na">do</span> <span class="err">|</span><span class="na">webhook_request</span><span class="err">|</span> <span class="err">%</span><span class="nt">&gt;</span>
	    <span class="nt">&lt;tr&gt;</span>
	      <span class="nt">&lt;td&gt;&lt;</span><span class="err">%=</span> <span class="na">link_to</span> <span class="na">webhook_request.id</span><span class="err">,</span> <span class="na">webhook_request_path</span><span class="err">(@</span><span class="na">webhook.slug</span><span class="err">,</span> <span class="na">webhook_request</span><span class="err">)</span> <span class="err">%</span><span class="nt">&gt;&lt;/td&gt;</span>
	      <span class="nt">&lt;td&gt;&lt;</span><span class="err">%=</span> <span class="na">webhook_request.method</span> <span class="err">%</span><span class="nt">&gt;&lt;/td&gt;</span>
	      <span class="nt">&lt;td&gt;&lt;</span><span class="err">%=</span> <span class="na">webhook_request.url</span> <span class="err">%</span><span class="nt">&gt;&lt;/td&gt;</span>
	      <span class="nt">&lt;td&gt;&lt;</span><span class="err">%=</span> <span class="na">webhook_request.ip</span> <span class="err">%</span><span class="nt">&gt;&lt;/td&gt;</span>
	      <span class="nt">&lt;td&gt;&lt;</span><span class="err">%=</span> <span class="na">webhook_request.created_at</span> <span class="err">%</span><span class="nt">&gt;&lt;/td&gt;</span>
	    <span class="nt">&lt;/tr&gt;</span>
	  <span class="nt">&lt;</span><span class="err">%</span> <span class="na">end</span> <span class="err">%</span><span class="nt">&gt;</span>
	<span class="nt">&lt;/tbody&gt;</span>
<span class="nt">&lt;/table&gt;</span>
</code></pre></div></div> <p>And update our Stimulus controller to insert new rows:</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">received</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">tbody</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">webhook-request-list</span><span class="dl">"</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">newRow</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">"</span><span class="s2">tr</span><span class="dl">"</span><span class="p">);</span>
  <span class="nx">newRow</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">`
    &lt;td&gt;&lt;a href="/webhooks/</span><span class="p">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">webhook_uuid</span><span class="p">}</span><span class="s2">/webhook_requests/</span><span class="p">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="s2">"&gt;</span><span class="p">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="s2">&lt;/a&gt;&lt;/td&gt;
    &lt;td&gt;</span><span class="p">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">method</span><span class="p">}</span><span class="s2">&lt;/td&gt;
    &lt;td&gt;</span><span class="p">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">host</span><span class="p">}</span><span class="s2">&lt;/td&gt;
    &lt;td&gt;</span><span class="p">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">ip</span> <span class="o">||</span> <span class="dl">'</span><span class="s1">N/A</span><span class="dl">'</span><span class="p">}</span><span class="s2">&lt;/td&gt;
    &lt;td&gt;</span><span class="p">${</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">created_at</span><span class="p">).</span><span class="nx">toLocaleString</span><span class="p">()}</span><span class="s2">&lt;/td&gt;
  `</span><span class="p">;</span>
  <span class="nx">tbody</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">newRow</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div> <p>And that‚Äôs it! Now when a webhook comes in, it appears instantly in the table without requiring a page refresh. The real magic of Action Cable is how it makes these real-time updates feel seamless.</p> <p><img src="/assets/images/posts/d038c7a9-8c1a-46cd-9159-0c88ef4ffa04-Screen_Recording_Dec_21_2024_%281%29.gif" alt="" /></p> <p>In the next post, we‚Äôll look at how to make our webhook interesting by implement styling using tailwindcss. Stay tuned! üöÄ</p> </div> <div class="grid grid-cols-2 text-sm"> <a class="prev" href="https://rslhdyt.dev/understanding-websocket-the-foundation-of-real-time-web/">&laquo; Understanding WebSocket: The Foundation of Real-time Web</a> <a class="next" href="https://rslhdyt.dev/til-handling-changes-to-sidekiq-worker-class/">TIL: Handling Changes to Sidekiq Worker Class &raquo;</a> </div> <div class="related"> <h4 class="text-xl my-5">Related Posts</h4> <ul class="list-disc list-inside"> <li class="pl-8"> <a href="https://rslhdyt.dev/setting-resource-limits-in-kamal-2/">Setting Resource Limits in Kamal 2 </a> </li> <li class="pl-8"> <a href="https://rslhdyt.dev/til-handling-changes-to-sidekiq-worker-class/">TIL: Handling Changes to Sidekiq Worker Class </a> </li> <li class="pl-8"> <a href="https://rslhdyt.dev/understanding-websocket-the-foundation-of-real-time-web/">Understanding WebSocket: The Foundation of Real-time Web </a> </li> <li class="pl-8"> <a href="https://rslhdyt.dev/handling-incoming-webhooks-the-controller-layer/">Handling Incoming Webhooks: The Controller Layer </a> </li> <li class="pl-8"> <a href="https://rslhdyt.dev/fix-dotenv-not-properly-setup-in-foreman/">Fix dotenv not properly setup in Foreman </a> </li> </ul> </div> <footer class="flex justify-center items-center border-solid border-0 border-t border-gray-200 p-10 mt-10"> Risal Hidayat ¬© 2025 </footer> </div> </body> </html>
